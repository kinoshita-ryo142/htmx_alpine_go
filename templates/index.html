{{ template "header" . }}

<main class="container mx-auto px-4 py-8 max-w-lg">
    <h1 class="text-2xl font-bold mb-6 text-gray-800">お問い合わせ</h1>

    <div id="contact-form" 
         x-data="{ 
            name: '', 
            email: '', 
            message: '',
            isDirty: false, // 一度でも送信しようとしたか
            get isValid() { 
                return this.name.length > 0 && 
                       this.email.includes('@') && 
                       this.message.length >= 10;
            }
         }"
    >
        <form 
            hx-post="/contact" 
            hx-target="#contact-form" 
            hx-swap="outerHTML"
            @submit="if(!isValid) { isDirty = true; $event.preventDefault(); }"
        >
            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2">お名前</label>
                <input type="text" name="name" x-model="name" required
                    class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-blue-500"
                    :class="{ 'border-red-500': isDirty && name === '' }"
                    :aria-invalid="isDirty && name === ''"
                    placeholder="山田 太郎">
                <p x-show="isDirty && name === ''" class="text-red-500 text-xs mt-1">※お名前を入力してください</p>
            </div>

            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2">メールアドレス</label>
                <input type="email" name="email" x-model="email" required
                    class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-blue-500"
                    :class="{ 'border-red-500': isDirty && !email.includes('@') }"
                    :aria-invalid="isDirty && !email.includes('@')"
                    placeholder="example@email.com">
                <p x-show="isDirty && !email.includes('@')" class="text-red-500 text-xs mt-1">※正しいメールアドレスを入力してください</p>
            </div>

            <div class="mb-6">
                <label class="block text-gray-700 text-sm font-bold mb-2">お問い合わせ内容 (10文字以上)</label>
                <textarea name="message" x-model="message" rows="4" required minlength="10"
                    class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-blue-500"
                    :class="{ 'border-red-500': isDirty && message.length < 10 }"
                    :aria-invalid="isDirty && message.length < 10"></textarea>
                <p x-show="isDirty && message.length < 10" class="text-red-500 text-xs mt-1">※内容は10文字以上で入力してください</p>
            </div>

            <button type="submit"
                :disabled="!isValid"
                :aria-disabled="!isValid"
                class="w-full font-bold py-2 px-4 rounded transition duration-200"
                :class="isValid ? 'bg-blue-600 hover:bg-blue-700 text-white cursor-pointer' : 'bg-gray-300 text-gray-500 cursor-not-allowed opacity-60'"
                @click="isDirty = true"
            >
                送信する
            </button>
        </form>
    </div>
</main>

{{ template "footer" . }}